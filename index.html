<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stopwatch</title>
    <meta
      name="description"
      content="Minimalist Stopwatch Website with no junk. Made by Nusab19"
    />
    <meta property="og:image" content="https://clocked.pages.dev/opengraph.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:wght@400;700&family=Ubuntu:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Ubuntu", "system-ui", "sans-serif"],
              mono: ['"Ubuntu Mono"', "ui-monospace", "monospace"],
            },
            colors: {
              primary: "#3b82f6",
              "primary-hover": "#2563eb",
              running: "#0ea5e9",
              "running-hover": "#0284c7",
              active: "#bfdbfe",
              muted: "#71717a",
            },
            borderRadius: { "4xl": "2rem" },
          },
        },
      };
    </script>

    <style>
      *,
      *::before,
      *::after {
        outline: none !important;
      }
      button {
        -webkit-tap-highlight-color: transparent;
      }
      #display {
        display: flex;
        justify-content: center;
        align-items: center;
      }
    </style>
  </head>

  <body
    class="h-screen bg-neutral-950 flex flex-col items-center justify-center px-4"
  >
    <div class="w-full max-w-2xl text-center flex flex-col items-center">
      <h1
        id="display"
        class="text-5xl xs:text-6xl sm:text-7xl md:text-8xl lg:text-9xl xl:text-[10rem] leading-none font-bold tracking-tighter font-mono select-none mb-8 sm:mb-12 md:mb-16"
      ></h1>

      <div
        class="flex justify-center gap-3 sm:gap-4 md:gap-6 mb-6 sm:mb-8 w-full max-w-xl px-2"
      >
        <button
          id="startPauseBtn"
          class="flex-1 max-w-[200px] px-8 sm:px-12 md:px-16 py-5 sm:py-6 md:py-8 rounded-3xl sm:rounded-4xl bg-primary text-white text-xl sm:text-2xl md:text-3xl font-bold shadow-2xl hover:bg-primary-hover transition-all duration-300 active:scale-95"
        >
          <span id="startPauseText">Start</span>
        </button>

        <button
          id="resetBtn"
          class="flex-1 max-w-[200px] px-8 sm:px-12 md:px-16 py-5 sm:py-6 md:py-8 rounded-3xl sm:rounded-4xl bg-neutral-800 text-white text-xl sm:text-2xl md:text-3xl font-bold shadow-2xl hover:bg-neutral-700 transition-all duration-300 active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed"
          disabled
        >
          Reset
        </button>
      </div>

      <p class="text-neutral-500 text-sm sm:text-base font-medium px-4">
        Press
        <kbd
          class="px-2 sm:px-3 py-1 bg-neutral-800 rounded text-neutral-300 text-xs sm:text-sm font-medium"
          >Space</kbd
        >
        to Start / Pause
      </p>
    </div>

    <footer
      class="absolute bottom-4 flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-3 text-center text-xs text-slate-500 opacity-50 px-4"
    >
      <div class="flex items-center gap-3">
        <a
          href="https://github.com/Nusab19/clocked/"
          target="_blank"
          rel="noopener noreferrer"
          class="fill-slate-500 hover:fill-slate-300 transition-colors"
        >
          <svg
            class="w-5 h-5"
            role="img"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <title>GitHub</title>
            <path
              d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"
            />
          </svg>
        </a>
        <p class="flex items-center justify-center gap-1 flex-wrap">
          Made by
          <a
            href="https://nusab19.pages.dev"
            target="_blank"
            rel="noopener noreferrer"
            class="text-slate-400 hover:text-slate-200 font-medium underline transition-colors"
          >
            Nusab Taha
          </a>
          <img
            src="https://flagcdn.com/w20/bd.png"
            alt="Bangladesh Flag"
            class="w-4 h-3 rounded-sm border border-slate-600"
          />
        </p>
      </div>
    </footer>

    <script>
      const display = document.getElementById("display");
      const startPauseBtn = document.getElementById("startPauseBtn");
      const startPauseText = document.getElementById("startPauseText");
      const resetBtn = document.getElementById("resetBtn");

      let startTime = 0;
      let elapsedTime = 0;
      let timerInterval = null;
      let saveInterval = null;
      let isRunning = false;
      const STORAGE_KEY = "stopwatch_state";

      function formatTime(ms) {
        const totalSeconds = Math.floor(ms / 1000);
        const hours = Math.floor(totalSeconds / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;
        const centi = Math.floor((ms % 1000) / 10);

        const hStr = String(hours).padStart(2, "0");
        const mStr = String(minutes).padStart(2, "0");
        const sStr = String(seconds).padStart(2, "0");
        const cStr = String(centi).padStart(2, "0");

        const activeClass = "text-active";
        const mutedClass = "text-muted";

        return `
        <span class="${
          hours > 0 ? activeClass : mutedClass
        }">${hStr}</span>:<span class="${
          minutes > 0 || hours > 0 ? activeClass : mutedClass
        }">${mStr}</span>:<span class="${
          seconds > 0 || minutes > 0 || hours > 0 ? activeClass : mutedClass
        }">${sStr}</span>.<span class="text-muted text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl">${cStr}</span>
      `;
      }

      function updateDisplay() {
        display.innerHTML = formatTime(elapsedTime);
      }

      function saveState() {
        const state = {
          elapsedTime,
          isRunning,
          lastSaved: Date.now(),
        };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      }

      function start() {
        if (isRunning) return;
        isRunning = true;
        startTime = Date.now() - elapsedTime;

        timerInterval = setInterval(() => {
          elapsedTime = Date.now() - startTime;
          updateDisplay();
        }, 10);

        saveInterval = setInterval(saveState, 1000);

        startPauseText.textContent = "Pause";
        startPauseBtn.classList.replace("bg-primary", "bg-running");
        startPauseBtn.classList.replace(
          "hover:bg-primary-hover",
          "hover:bg-running-hover"
        );
        resetBtn.disabled = false;
        resetBtn.classList.remove("opacity-40", "cursor-not-allowed");
        saveState();
      }

      function pause() {
        clearInterval(timerInterval);
        clearInterval(saveInterval);
        isRunning = false;
        startPauseText.textContent = "Start";
        startPauseBtn.classList.replace("bg-running", "bg-primary");
        startPauseBtn.classList.replace(
          "hover:bg-running-hover",
          "hover:bg-primary-hover"
        );
        saveState();
      }

      function reset() {
        if (!confirm("Reset stopwatch to 00:00:00.00?")) return;

        clearInterval(timerInterval);
        clearInterval(saveInterval);
        isRunning = false;
        elapsedTime = 0;
        updateDisplay();
        startPauseText.textContent = "Start";
        startPauseBtn.classList.replace("bg-running", "bg-primary");
        startPauseBtn.classList.replace(
          "hover:bg-running-hover",
          "hover:bg-primary-hover"
        );
        resetBtn.disabled = true;
        resetBtn.classList.add("opacity-40", "cursor-not-allowed");
        localStorage.removeItem(STORAGE_KEY);
      }

      function loadState() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (!saved) {
          updateDisplay();
          return;
        }

        const state = JSON.parse(saved);
        elapsedTime = state.elapsedTime || 0;

        if (state.isRunning) {
          const timeSinceLastSave =
            Date.now() - (state.lastSaved || Date.now());
          elapsedTime += timeSinceLastSave;
          startTime = Date.now() - elapsedTime;
          start();
        } else {
          updateDisplay();
          if (elapsedTime > 0) {
            resetBtn.disabled = false;
            resetBtn.classList.remove("opacity-40", "cursor-not-allowed");
          }
        }
      }

      startPauseBtn.addEventListener("click", () =>
        isRunning ? pause() : start()
      );
      resetBtn.addEventListener("click", reset);

      document.addEventListener("keydown", (e) => {
        if (e.code === "Space") {
          e.preventDefault();
          startPauseBtn.click();
        }
      });

      window.addEventListener("beforeunload", () => {
        if (isRunning) {
          saveState();
        }
      });

      loadState();
    </script>
  </body>
</html>
